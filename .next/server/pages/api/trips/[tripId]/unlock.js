"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/trips/[tripId]/unlock";
exports.ids = ["pages/api/trips/[tripId]/unlock"];
exports.modules = {

/***/ "bcryptjs":
/*!***************************!*\
  !*** external "bcryptjs" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("bcryptjs");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "sql.js":
/*!*************************!*\
  !*** external "sql.js" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("sql.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftrips%2F%5BtripId%5D%2Funlock&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ctrips%5C%5BtripId%5D%5Cunlock.js&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftrips%2F%5BtripId%5D%2Funlock&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ctrips%5C%5BtripId%5D%5Cunlock.js&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_trips_tripId_unlock_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\trips\\[tripId]\\unlock.js */ \"(api)/./pages/api/trips/[tripId]/unlock.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_trips_tripId_unlock_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_trips_tripId_unlock_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/trips/[tripId]/unlock\",\n        pathname: \"/api/trips/[tripId]/unlock\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_trips_tripId_unlock_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnRyaXBzJTJGJTVCdHJpcElkJTVEJTJGdW5sb2NrJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUN0cmlwcyU1QyU1QnRyaXBJZCU1RCU1Q3VubG9jay5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUNxRTtBQUNyRTtBQUNBLGlFQUFlLHdFQUFLLENBQUMsOERBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLDhEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL2Jhbmdpbi10cmF2ZWwvP2Q3OTUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFx0cmlwc1xcXFxbdHJpcElkXVxcXFx1bmxvY2suanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS90cmlwcy9bdHJpcElkXS91bmxvY2tcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS90cmlwcy9bdHJpcElkXS91bmxvY2tcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftrips%2F%5BtripId%5D%2Funlock&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ctrips%5C%5BtripId%5D%5Cunlock.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/auth.js":
/*!*********************!*\
  !*** ./lib/auth.js ***!
  \*********************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("/**\r\n * Authentication Module - JWT tokens and passcode hashing\r\n */ \nconst jwt = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\nconst bcrypt = __webpack_require__(/*! bcryptjs */ \"bcryptjs\");\n// Secret key - in production, use environment variable\nconst JWT_SECRET = process.env.JWT_SECRET || \"bangin-travel-secret-key-change-in-production\";\nconst TOKEN_EXPIRY = \"7d\"; // 7 days\nconst BCRYPT_ROUNDS = 10;\n/**\r\n * Hash a passcode using bcrypt\r\n */ async function hashPasscode(passcode) {\n    return bcrypt.hash(passcode, BCRYPT_ROUNDS);\n}\n/**\r\n * Verify a passcode against a hash\r\n */ async function verifyPasscode(passcode, hash) {\n    return bcrypt.compare(passcode, hash);\n}\n/**\r\n * Generate a JWT token for a trip\r\n */ function generateToken(tripId) {\n    const payload = {\n        tripId,\n        iat: Math.floor(Date.now() / 1000)\n    };\n    return jwt.sign(payload, JWT_SECRET, {\n        expiresIn: TOKEN_EXPIRY\n    });\n}\n/**\r\n * Verify and decode a JWT token\r\n */ function verifyToken(token) {\n    try {\n        const decoded = jwt.verify(token, JWT_SECRET);\n        return {\n            valid: true,\n            tripId: decoded.tripId,\n            exp: decoded.exp\n        };\n    } catch (error) {\n        return {\n            valid: false,\n            error: error.message\n        };\n    }\n}\n/**\r\n * Extract token from Authorization header\r\n */ function extractToken(authHeader) {\n    if (!authHeader) return null;\n    if (authHeader.startsWith(\"Bearer \")) {\n        return authHeader.slice(7);\n    }\n    return null;\n}\n/**\r\n * Calculate token expiration date\r\n */ function getTokenExpiry(token) {\n    try {\n        const decoded = jwt.decode(token);\n        if (decoded && decoded.exp) {\n            return new Date(decoded.exp * 1000).toISOString();\n        }\n    } catch  {\n    // Ignore decode errors\n    }\n    return null;\n}\nmodule.exports = {\n    hashPasscode,\n    verifyPasscode,\n    generateToken,\n    verifyToken,\n    extractToken,\n    getTokenExpiry\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvYXV0aC5qcyIsIm1hcHBpbmdzIjoiQUFBQTs7Q0FFQztBQUVELE1BQU1BLE1BQU1DLG1CQUFPQSxDQUFDO0FBQ3BCLE1BQU1DLFNBQVNELG1CQUFPQSxDQUFDO0FBRXZCLHVEQUF1RDtBQUN2RCxNQUFNRSxhQUFhQyxRQUFRQyxHQUFHLENBQUNGLFVBQVUsSUFBSTtBQUM3QyxNQUFNRyxlQUFlLE1BQU0sU0FBUztBQUNwQyxNQUFNQyxnQkFBZ0I7QUFFdEI7O0NBRUMsR0FDRCxlQUFlQyxhQUFhQyxRQUFRO0lBQ2hDLE9BQU9QLE9BQU9RLElBQUksQ0FBQ0QsVUFBVUY7QUFDakM7QUFFQTs7Q0FFQyxHQUNELGVBQWVJLGVBQWVGLFFBQVEsRUFBRUMsSUFBSTtJQUN4QyxPQUFPUixPQUFPVSxPQUFPLENBQUNILFVBQVVDO0FBQ3BDO0FBRUE7O0NBRUMsR0FDRCxTQUFTRyxjQUFjQyxNQUFNO0lBQ3pCLE1BQU1DLFVBQVU7UUFDWkQ7UUFDQUUsS0FBS0MsS0FBS0MsS0FBSyxDQUFDQyxLQUFLQyxHQUFHLEtBQUs7SUFDakM7SUFFQSxPQUFPcEIsSUFBSXFCLElBQUksQ0FBQ04sU0FBU1osWUFBWTtRQUFFbUIsV0FBV2hCO0lBQWE7QUFDbkU7QUFFQTs7Q0FFQyxHQUNELFNBQVNpQixZQUFZQyxLQUFLO0lBQ3RCLElBQUk7UUFDQSxNQUFNQyxVQUFVekIsSUFBSTBCLE1BQU0sQ0FBQ0YsT0FBT3JCO1FBQ2xDLE9BQU87WUFDSHdCLE9BQU87WUFDUGIsUUFBUVcsUUFBUVgsTUFBTTtZQUN0QmMsS0FBS0gsUUFBUUcsR0FBRztRQUNwQjtJQUNKLEVBQUUsT0FBT0MsT0FBTztRQUNaLE9BQU87WUFDSEYsT0FBTztZQUNQRSxPQUFPQSxNQUFNQyxPQUFPO1FBQ3hCO0lBQ0o7QUFDSjtBQUVBOztDQUVDLEdBQ0QsU0FBU0MsYUFBYUMsVUFBVTtJQUM1QixJQUFJLENBQUNBLFlBQVksT0FBTztJQUV4QixJQUFJQSxXQUFXQyxVQUFVLENBQUMsWUFBWTtRQUNsQyxPQUFPRCxXQUFXRSxLQUFLLENBQUM7SUFDNUI7SUFFQSxPQUFPO0FBQ1g7QUFFQTs7Q0FFQyxHQUNELFNBQVNDLGVBQWVYLEtBQUs7SUFDekIsSUFBSTtRQUNBLE1BQU1DLFVBQVV6QixJQUFJb0MsTUFBTSxDQUFDWjtRQUMzQixJQUFJQyxXQUFXQSxRQUFRRyxHQUFHLEVBQUU7WUFDeEIsT0FBTyxJQUFJVCxLQUFLTSxRQUFRRyxHQUFHLEdBQUcsTUFBTVMsV0FBVztRQUNuRDtJQUNKLEVBQUUsT0FBTTtJQUNKLHVCQUF1QjtJQUMzQjtJQUNBLE9BQU87QUFDWDtBQUVBQyxPQUFPQyxPQUFPLEdBQUc7SUFDYi9CO0lBQ0FHO0lBQ0FFO0lBQ0FVO0lBQ0FRO0lBQ0FJO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYW5naW4tdHJhdmVsLy4vbGliL2F1dGguanM/Mjg3YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQXV0aGVudGljYXRpb24gTW9kdWxlIC0gSldUIHRva2VucyBhbmQgcGFzc2NvZGUgaGFzaGluZ1xyXG4gKi9cclxuXHJcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xyXG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHRqcycpO1xyXG5cclxuLy8gU2VjcmV0IGtleSAtIGluIHByb2R1Y3Rpb24sIHVzZSBlbnZpcm9ubWVudCB2YXJpYWJsZVxyXG5jb25zdCBKV1RfU0VDUkVUID0gcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCB8fCAnYmFuZ2luLXRyYXZlbC1zZWNyZXQta2V5LWNoYW5nZS1pbi1wcm9kdWN0aW9uJztcclxuY29uc3QgVE9LRU5fRVhQSVJZID0gJzdkJzsgLy8gNyBkYXlzXHJcbmNvbnN0IEJDUllQVF9ST1VORFMgPSAxMDtcclxuXHJcbi8qKlxyXG4gKiBIYXNoIGEgcGFzc2NvZGUgdXNpbmcgYmNyeXB0XHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBoYXNoUGFzc2NvZGUocGFzc2NvZGUpIHtcclxuICAgIHJldHVybiBiY3J5cHQuaGFzaChwYXNzY29kZSwgQkNSWVBUX1JPVU5EUyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWZXJpZnkgYSBwYXNzY29kZSBhZ2FpbnN0IGEgaGFzaFxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gdmVyaWZ5UGFzc2NvZGUocGFzc2NvZGUsIGhhc2gpIHtcclxuICAgIHJldHVybiBiY3J5cHQuY29tcGFyZShwYXNzY29kZSwgaGFzaCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZW5lcmF0ZSBhIEpXVCB0b2tlbiBmb3IgYSB0cmlwXHJcbiAqL1xyXG5mdW5jdGlvbiBnZW5lcmF0ZVRva2VuKHRyaXBJZCkge1xyXG4gICAgY29uc3QgcGF5bG9hZCA9IHtcclxuICAgICAgICB0cmlwSWQsXHJcbiAgICAgICAgaWF0OiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gand0LnNpZ24ocGF5bG9hZCwgSldUX1NFQ1JFVCwgeyBleHBpcmVzSW46IFRPS0VOX0VYUElSWSB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZlcmlmeSBhbmQgZGVjb2RlIGEgSldUIHRva2VuXHJcbiAqL1xyXG5mdW5jdGlvbiB2ZXJpZnlUb2tlbih0b2tlbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBkZWNvZGVkID0gand0LnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVCk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdmFsaWQ6IHRydWUsXHJcbiAgICAgICAgICAgIHRyaXBJZDogZGVjb2RlZC50cmlwSWQsXHJcbiAgICAgICAgICAgIGV4cDogZGVjb2RlZC5leHBcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB2YWxpZDogZmFsc2UsXHJcbiAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3QgdG9rZW4gZnJvbSBBdXRob3JpemF0aW9uIGhlYWRlclxyXG4gKi9cclxuZnVuY3Rpb24gZXh0cmFjdFRva2VuKGF1dGhIZWFkZXIpIHtcclxuICAgIGlmICghYXV0aEhlYWRlcikgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgaWYgKGF1dGhIZWFkZXIuc3RhcnRzV2l0aCgnQmVhcmVyICcpKSB7XHJcbiAgICAgICAgcmV0dXJuIGF1dGhIZWFkZXIuc2xpY2UoNyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDYWxjdWxhdGUgdG9rZW4gZXhwaXJhdGlvbiBkYXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRUb2tlbkV4cGlyeSh0b2tlbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBkZWNvZGVkID0gand0LmRlY29kZSh0b2tlbik7XHJcbiAgICAgICAgaWYgKGRlY29kZWQgJiYgZGVjb2RlZC5leHApIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGRlY29kZWQuZXhwICogMTAwMCkudG9JU09TdHJpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgICAvLyBJZ25vcmUgZGVjb2RlIGVycm9yc1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgaGFzaFBhc3Njb2RlLFxyXG4gICAgdmVyaWZ5UGFzc2NvZGUsXHJcbiAgICBnZW5lcmF0ZVRva2VuLFxyXG4gICAgdmVyaWZ5VG9rZW4sXHJcbiAgICBleHRyYWN0VG9rZW4sXHJcbiAgICBnZXRUb2tlbkV4cGlyeVxyXG59O1xyXG4iXSwibmFtZXMiOlsiand0IiwicmVxdWlyZSIsImJjcnlwdCIsIkpXVF9TRUNSRVQiLCJwcm9jZXNzIiwiZW52IiwiVE9LRU5fRVhQSVJZIiwiQkNSWVBUX1JPVU5EUyIsImhhc2hQYXNzY29kZSIsInBhc3Njb2RlIiwiaGFzaCIsInZlcmlmeVBhc3Njb2RlIiwiY29tcGFyZSIsImdlbmVyYXRlVG9rZW4iLCJ0cmlwSWQiLCJwYXlsb2FkIiwiaWF0IiwiTWF0aCIsImZsb29yIiwiRGF0ZSIsIm5vdyIsInNpZ24iLCJleHBpcmVzSW4iLCJ2ZXJpZnlUb2tlbiIsInRva2VuIiwiZGVjb2RlZCIsInZlcmlmeSIsInZhbGlkIiwiZXhwIiwiZXJyb3IiLCJtZXNzYWdlIiwiZXh0cmFjdFRva2VuIiwiYXV0aEhlYWRlciIsInN0YXJ0c1dpdGgiLCJzbGljZSIsImdldFRva2VuRXhwaXJ5IiwiZGVjb2RlIiwidG9JU09TdHJpbmciLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/auth.js\n");

/***/ }),

/***/ "(api)/./lib/db.js":
/*!*******************!*\
  !*** ./lib/db.js ***!
  \*******************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("/**\r\n * Database Module - SQLite with sql.js (pure JavaScript)\r\n * Handles database initialization, schema, and queries\r\n */ // Dynamic require to avoid top-level issues in Next.js\n// const initSqlJs = require('sql.js');\n\nconst fs = __webpack_require__(/*! fs */ \"fs\");\nconst path = __webpack_require__(/*! path */ \"path\");\nconst DB_PATH = path.join(process.cwd(), \"data\", \"bangin-travel.db\");\nlet db = null;\nlet SQL = null;\nconst SCHEMA = `\r\n-- Trips table\r\nCREATE TABLE IF NOT EXISTS trips (\r\n  id TEXT PRIMARY KEY,\r\n  name TEXT NOT NULL,\r\n  destination TEXT,\r\n  start_date TEXT,\r\n  end_date TEXT,\r\n  timezone TEXT DEFAULT 'UTC',\r\n  cover_image TEXT,\r\n  passcode_hash TEXT NOT NULL,\r\n  created_at TEXT DEFAULT CURRENT_TIMESTAMP,\r\n  updated_at TEXT DEFAULT CURRENT_TIMESTAMP\r\n);\r\n\r\n-- Travelers table\r\nCREATE TABLE IF NOT EXISTS travelers (\r\n  id TEXT PRIMARY KEY,\r\n  trip_id TEXT NOT NULL REFERENCES trips(id) ON DELETE CASCADE,\r\n  display_name TEXT NOT NULL,\r\n  email TEXT,\r\n  initials TEXT,\r\n  color TEXT,\r\n  notes TEXT,\r\n  is_organizer INTEGER DEFAULT 0,\r\n  created_at TEXT DEFAULT CURRENT_TIMESTAMP,\r\n  updated_at TEXT DEFAULT CURRENT_TIMESTAMP\r\n);\r\nCREATE INDEX IF NOT EXISTS idx_travelers_trip ON travelers(trip_id);\r\n\r\n-- Items table (unified for all item types)\r\nCREATE TABLE IF NOT EXISTS items (\r\n  id TEXT PRIMARY KEY,\r\n  trip_id TEXT NOT NULL REFERENCES trips(id) ON DELETE CASCADE,\r\n  type TEXT NOT NULL CHECK (type IN ('flight', 'transit', 'stay', 'activity')),\r\n  status TEXT DEFAULT 'idea' CHECK (status IN ('idea', 'pending', 'booked', 'dropped')),\r\n  title TEXT NOT NULL,\r\n  notes TEXT,\r\n  link_url TEXT,\r\n  start_at TEXT,\r\n  end_at TEXT,\r\n  metadata TEXT,\r\n  created_at TEXT DEFAULT CURRENT_TIMESTAMP,\r\n  updated_at TEXT DEFAULT CURRENT_TIMESTAMP\r\n);\r\nCREATE INDEX IF NOT EXISTS idx_items_trip ON items(trip_id);\r\nCREATE INDEX IF NOT EXISTS idx_items_type ON items(trip_id, type);\r\n\r\n-- Item-Traveler assignments (many-to-many)\r\nCREATE TABLE IF NOT EXISTS item_travelers (\r\n  item_id TEXT NOT NULL REFERENCES items(id) ON DELETE CASCADE,\r\n  traveler_id TEXT NOT NULL REFERENCES travelers(id) ON DELETE CASCADE,\r\n  role TEXT,\r\n  created_at TEXT DEFAULT CURRENT_TIMESTAMP,\r\n  PRIMARY KEY (item_id, traveler_id)\r\n);\r\nCREATE INDEX IF NOT EXISTS idx_item_travelers_item ON item_travelers(item_id);\r\nCREATE INDEX IF NOT EXISTS idx_item_travelers_traveler ON item_travelers(traveler_id);\r\n`;\nasync function initDatabase() {\n    if (db) return db;\n    if (!SQL) {\n        const initSqlJs = __webpack_require__(/*! sql.js */ \"sql.js\");\n        SQL = await initSqlJs();\n    }\n    // Ensure data directory exists\n    const dataDir = path.dirname(DB_PATH);\n    if (!fs.existsSync(dataDir)) {\n        fs.mkdirSync(dataDir, {\n            recursive: true\n        });\n    }\n    // Load existing database or create new one\n    if (fs.existsSync(DB_PATH)) {\n        const buffer = fs.readFileSync(DB_PATH);\n        db = new SQL.Database(buffer);\n    } else {\n        db = new SQL.Database();\n        // Run schema\n        db.run(SCHEMA);\n        saveDatabase();\n    }\n    // Enable foreign keys\n    db.run(\"PRAGMA foreign_keys = ON\");\n    return db;\n}\nfunction saveDatabase() {\n    if (db) {\n        const data = db.export();\n        const buffer = Buffer.from(data);\n        fs.writeFileSync(DB_PATH, buffer);\n    }\n}\nfunction generateId(prefix = \"\") {\n    const timestamp = Date.now().toString(36);\n    const random = Math.random().toString(36).substr(2, 9);\n    return prefix ? `${prefix}-${timestamp}-${random}` : `${timestamp}-${random}`;\n}\n// Trip queries\nconst trips = {\n    create: async (name, passcodeHash, destination = \"\", startDate = \"\", endDate = \"\", timezone = \"UTC\")=>{\n        await initDatabase();\n        const id = generateId(\"trip\");\n        const createdAt = new Date().toISOString();\n        db.run(`INSERT INTO trips (id, name, destination, start_date, end_date, timezone, passcode_hash, created_at, updated_at)\r\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)`, [\n            id,\n            name,\n            destination,\n            startDate,\n            endDate,\n            timezone,\n            passcodeHash,\n            createdAt,\n            createdAt\n        ]);\n        saveDatabase();\n        return {\n            id,\n            name,\n            destination,\n            startDate,\n            endDate,\n            timezone,\n            createdAt\n        };\n    },\n    list: async ()=>{\n        await initDatabase();\n        const result = db.exec(\"SELECT id, name, destination, start_date, end_date FROM trips ORDER BY created_at DESC\");\n        if (!result.length) return [];\n        return result[0].values.map((row)=>({\n                id: row[0],\n                name: row[1],\n                destination: row[2],\n                startDate: row[3],\n                endDate: row[4]\n            }));\n    },\n    getById: async (id)=>{\n        await initDatabase();\n        const result = db.exec(\"SELECT * FROM trips WHERE id = ?\", [\n            id\n        ]);\n        if (!result.length || !result[0].values.length) return null;\n        const row = result[0].values[0];\n        const columns = result[0].columns;\n        const trip = {};\n        columns.forEach((col, i)=>{\n            trip[col] = row[i];\n        });\n        return trip;\n    },\n    getPasscodeHash: async (id)=>{\n        await initDatabase();\n        const result = db.exec(\"SELECT passcode_hash FROM trips WHERE id = ?\", [\n            id\n        ]);\n        if (!result.length || !result[0].values.length) return null;\n        return result[0].values[0][0];\n    }\n};\n// Traveler queries\nconst travelers = {\n    create: async (tripId, displayName, email = \"\", initials = \"\", color = \"\", notes = \"\", isOrganizer = false)=>{\n        await initDatabase();\n        const id = generateId(\"t\");\n        const createdAt = new Date().toISOString();\n        db.run(`INSERT INTO travelers (id, trip_id, display_name, email, initials, color, notes, is_organizer, created_at, updated_at)\r\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`, [\n            id,\n            tripId,\n            displayName,\n            email,\n            initials,\n            color,\n            notes,\n            isOrganizer ? 1 : 0,\n            createdAt,\n            createdAt\n        ]);\n        saveDatabase();\n        return {\n            id,\n            tripId,\n            displayName,\n            email,\n            initials,\n            color,\n            notes,\n            isOrganizer,\n            createdAt\n        };\n    },\n    listByTrip: async (tripId)=>{\n        await initDatabase();\n        const result = db.exec(\"SELECT id, display_name, email, initials, color, notes, is_organizer, created_at FROM travelers WHERE trip_id = ? ORDER BY created_at ASC\", [\n            tripId\n        ]);\n        if (!result.length) return [];\n        return result[0].values.map((row)=>({\n                id: row[0],\n                displayName: row[1],\n                email: row[2],\n                initials: row[3],\n                color: row[4],\n                notes: row[5],\n                isOrganizer: row[6] === 1,\n                createdAt: row[7]\n            }));\n    },\n    getById: async (id)=>{\n        await initDatabase();\n        const result = db.exec(\"SELECT * FROM travelers WHERE id = ?\", [\n            id\n        ]);\n        if (!result.length || !result[0].values.length) return null;\n        const row = result[0].values[0];\n        return {\n            id: row[0],\n            tripId: row[1],\n            displayName: row[2],\n            email: row[3],\n            initials: row[4],\n            color: row[5],\n            notes: row[6],\n            isOrganizer: row[7] === 1,\n            createdAt: row[8],\n            updatedAt: row[9]\n        };\n    },\n    update: async (id, updates)=>{\n        await initDatabase();\n        const fields = [];\n        const values = [];\n        if (updates.displayName !== undefined) {\n            fields.push(\"display_name = ?\");\n            values.push(updates.displayName);\n        }\n        if (updates.email !== undefined) {\n            fields.push(\"email = ?\");\n            values.push(updates.email);\n        }\n        if (updates.initials !== undefined) {\n            fields.push(\"initials = ?\");\n            values.push(updates.initials);\n        }\n        if (updates.color !== undefined) {\n            fields.push(\"color = ?\");\n            values.push(updates.color);\n        }\n        if (updates.notes !== undefined) {\n            fields.push(\"notes = ?\");\n            values.push(updates.notes);\n        }\n        if (updates.isOrganizer !== undefined) {\n            fields.push(\"is_organizer = ?\");\n            values.push(updates.isOrganizer ? 1 : 0);\n        }\n        if (fields.length === 0) return false;\n        fields.push(\"updated_at = ?\");\n        values.push(new Date().toISOString());\n        values.push(id);\n        db.run(`UPDATE travelers SET ${fields.join(\", \")} WHERE id = ?`, values);\n        saveDatabase();\n        return true;\n    },\n    delete: async (id)=>{\n        await initDatabase();\n        db.run(\"DELETE FROM travelers WHERE id = ?\", [\n            id\n        ]);\n        saveDatabase();\n        return true;\n    }\n};\n// Item queries\nconst items = {\n    create: async (tripId, type, title, options = {})=>{\n        await initDatabase();\n        const id = generateId(type.charAt(0));\n        const createdAt = new Date().toISOString();\n        const { notes = \"\", linkUrl = \"\", startAt = \"\", endAt = \"\", status = \"idea\", metadata = {} } = options;\n        db.run(`INSERT INTO items (id, trip_id, type, status, title, notes, link_url, start_at, end_at, metadata, created_at, updated_at)\r\n       VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`, [\n            id,\n            tripId,\n            type,\n            status,\n            title,\n            notes,\n            linkUrl,\n            startAt,\n            endAt,\n            JSON.stringify(metadata),\n            createdAt,\n            createdAt\n        ]);\n        saveDatabase();\n        return {\n            id,\n            tripId,\n            type,\n            status,\n            title,\n            notes,\n            linkUrl,\n            startAt,\n            endAt,\n            metadata,\n            createdAt,\n            travelers: []\n        };\n    },\n    listByTrip: async (tripId, type = null)=>{\n        await initDatabase();\n        let query = \"SELECT * FROM items WHERE trip_id = ?\";\n        const params = [\n            tripId\n        ];\n        if (type) {\n            query += \" AND type = ?\";\n            params.push(type);\n        }\n        query += \" ORDER BY start_at ASC, created_at ASC\";\n        const result = db.exec(query, params);\n        if (!result.length) return [];\n        const columns = result[0].columns;\n        return result[0].values.map((row)=>{\n            const item = {};\n            columns.forEach((col, i)=>{\n                if (col === \"metadata\") {\n                    try {\n                        item[col] = JSON.parse(row[i] || \"{}\");\n                    } catch  {\n                        item[col] = {};\n                    }\n                } else {\n                    item[col] = row[i];\n                }\n            });\n            // Convert snake_case to camelCase\n            return {\n                id: item.id,\n                tripId: item.trip_id,\n                type: item.type,\n                status: item.status,\n                title: item.title,\n                notes: item.notes,\n                linkUrl: item.link_url,\n                startAt: item.start_at,\n                endAt: item.end_at,\n                metadata: item.metadata,\n                createdAt: item.created_at,\n                updatedAt: item.updated_at\n            };\n        });\n    },\n    getById: async (id)=>{\n        await initDatabase();\n        const result = db.exec(\"SELECT * FROM items WHERE id = ?\", [\n            id\n        ]);\n        if (!result.length || !result[0].values.length) return null;\n        const row = result[0].values[0];\n        const columns = result[0].columns;\n        const item = {};\n        columns.forEach((col, i)=>{\n            if (col === \"metadata\") {\n                try {\n                    item[col] = JSON.parse(row[i] || \"{}\");\n                } catch  {\n                    item[col] = {};\n                }\n            } else {\n                item[col] = row[i];\n            }\n        });\n        return {\n            id: item.id,\n            tripId: item.trip_id,\n            type: item.type,\n            status: item.status,\n            title: item.title,\n            notes: item.notes,\n            linkUrl: item.link_url,\n            startAt: item.start_at,\n            endAt: item.end_at,\n            metadata: item.metadata,\n            createdAt: item.created_at,\n            updatedAt: item.updated_at\n        };\n    },\n    update: async (id, updates)=>{\n        await initDatabase();\n        const fields = [];\n        const values = [];\n        if (updates.title !== undefined) {\n            fields.push(\"title = ?\");\n            values.push(updates.title);\n        }\n        if (updates.notes !== undefined) {\n            fields.push(\"notes = ?\");\n            values.push(updates.notes);\n        }\n        if (updates.linkUrl !== undefined) {\n            fields.push(\"link_url = ?\");\n            values.push(updates.linkUrl);\n        }\n        if (updates.startAt !== undefined) {\n            fields.push(\"start_at = ?\");\n            values.push(updates.startAt);\n        }\n        if (updates.endAt !== undefined) {\n            fields.push(\"end_at = ?\");\n            values.push(updates.endAt);\n        }\n        if (updates.status !== undefined) {\n            fields.push(\"status = ?\");\n            values.push(updates.status);\n        }\n        if (updates.metadata !== undefined) {\n            fields.push(\"metadata = ?\");\n            values.push(JSON.stringify(updates.metadata));\n        }\n        if (fields.length === 0) return false;\n        fields.push(\"updated_at = ?\");\n        values.push(new Date().toISOString());\n        values.push(id);\n        db.run(`UPDATE items SET ${fields.join(\", \")} WHERE id = ?`, values);\n        saveDatabase();\n        return true;\n    },\n    delete: async (id)=>{\n        await initDatabase();\n        db.run(\"DELETE FROM items WHERE id = ?\", [\n            id\n        ]);\n        saveDatabase();\n        return true;\n    }\n};\n// Assignment queries\nconst assignments = {\n    assign: async (itemId, travelerId, role = null)=>{\n        await initDatabase();\n        const createdAt = new Date().toISOString();\n        try {\n            db.run(\"INSERT OR IGNORE INTO item_travelers (item_id, traveler_id, role, created_at) VALUES (?, ?, ?, ?)\", [\n                itemId,\n                travelerId,\n                role,\n                createdAt\n            ]);\n            saveDatabase();\n            return {\n                itemId,\n                travelerId,\n                role,\n                created: true\n            };\n        } catch  {\n            return {\n                itemId,\n                travelerId,\n                role,\n                created: false\n            };\n        }\n    },\n    unassign: async (itemId, travelerId)=>{\n        await initDatabase();\n        db.run(\"DELETE FROM item_travelers WHERE item_id = ? AND traveler_id = ?\", [\n            itemId,\n            travelerId\n        ]);\n        saveDatabase();\n        return true;\n    },\n    getByItem: async (itemId)=>{\n        await initDatabase();\n        const result = db.exec(\"SELECT traveler_id, role FROM item_travelers WHERE item_id = ?\", [\n            itemId\n        ]);\n        if (!result.length) return [];\n        return result[0].values.map((row)=>({\n                travelerId: row[0],\n                role: row[1]\n            }));\n    },\n    getByTraveler: async (travelerId)=>{\n        await initDatabase();\n        const result = db.exec(\"SELECT item_id, role FROM item_travelers WHERE traveler_id = ?\", [\n            travelerId\n        ]);\n        if (!result.length) return [];\n        return result[0].values.map((row)=>({\n                itemId: row[0],\n                role: row[1]\n            }));\n    }\n};\nmodule.exports = {\n    initDatabase,\n    saveDatabase,\n    generateId,\n    trips,\n    travelers,\n    items,\n    assignments\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUNyRCxPQUFPRSxNQUFNLEVBQUUsT0FBTyxFQUFFO1FBQzdCLE9BQU9GLE1BQU0sQ0FBQyxFQUFFLENBQUNHLE1BQU0sQ0FBQ0MsR0FBRyxDQUFDQyxDQUFBQSxNQUFRO2dCQUNoQ2lELFlBQVlqRCxHQUFHLENBQUMsRUFBRTtnQkFDbEJrRCxNQUFNbEQsR0FBRyxDQUFDLEVBQUU7WUFDaEI7SUFDSjtJQUVBc0QsZUFBZSxPQUFPTDtRQUNsQixNQUFNNUY7UUFDTixNQUFNc0MsU0FBU3pDLEdBQUcwQyxJQUFJLENBQ2xCLGtFQUNBO1lBQUNxRDtTQUFXO1FBRWhCLElBQUksQ0FBQ3RELE9BQU9FLE1BQU0sRUFBRSxPQUFPLEVBQUU7UUFDN0IsT0FBT0YsTUFBTSxDQUFDLEVBQUUsQ0FBQ0csTUFBTSxDQUFDQyxHQUFHLENBQUNDLENBQUFBLE1BQVE7Z0JBQ2hDZ0QsUUFBUWhELEdBQUcsQ0FBQyxFQUFFO2dCQUNka0QsTUFBTWxELEdBQUcsQ0FBQyxFQUFFO1lBQ2hCO0lBQ0o7QUFDSjtBQUVBdUQsT0FBT0MsT0FBTyxHQUFHO0lBQ2JuRztJQUNBVztJQUNBTTtJQUNBUztJQUNBeUI7SUFDQWdCO0lBQ0FzQjtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmFuZ2luLXRyYXZlbC8uL2xpYi9kYi5qcz8zZGM5Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBEYXRhYmFzZSBNb2R1bGUgLSBTUUxpdGUgd2l0aCBzcWwuanMgKHB1cmUgSmF2YVNjcmlwdClcclxuICogSGFuZGxlcyBkYXRhYmFzZSBpbml0aWFsaXphdGlvbiwgc2NoZW1hLCBhbmQgcXVlcmllc1xyXG4gKi9cclxuXHJcbi8vIER5bmFtaWMgcmVxdWlyZSB0byBhdm9pZCB0b3AtbGV2ZWwgaXNzdWVzIGluIE5leHQuanNcclxuLy8gY29uc3QgaW5pdFNxbEpzID0gcmVxdWlyZSgnc3FsLmpzJyk7XHJcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcclxuXHJcbmNvbnN0IERCX1BBVEggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2RhdGEnLCAnYmFuZ2luLXRyYXZlbC5kYicpO1xyXG5cclxubGV0IGRiID0gbnVsbDtcclxubGV0IFNRTCA9IG51bGw7XHJcblxyXG5jb25zdCBTQ0hFTUEgPSBgXHJcbi0tIFRyaXBzIHRhYmxlXHJcbkNSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHRyaXBzIChcclxuICBpZCBURVhUIFBSSU1BUlkgS0VZLFxyXG4gIG5hbWUgVEVYVCBOT1QgTlVMTCxcclxuICBkZXN0aW5hdGlvbiBURVhULFxyXG4gIHN0YXJ0X2RhdGUgVEVYVCxcclxuICBlbmRfZGF0ZSBURVhULFxyXG4gIHRpbWV6b25lIFRFWFQgREVGQVVMVCAnVVRDJyxcclxuICBjb3Zlcl9pbWFnZSBURVhULFxyXG4gIHBhc3Njb2RlX2hhc2ggVEVYVCBOT1QgTlVMTCxcclxuICBjcmVhdGVkX2F0IFRFWFQgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcclxuICB1cGRhdGVkX2F0IFRFWFQgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUFxyXG4pO1xyXG5cclxuLS0gVHJhdmVsZXJzIHRhYmxlXHJcbkNSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTIHRyYXZlbGVycyAoXHJcbiAgaWQgVEVYVCBQUklNQVJZIEtFWSxcclxuICB0cmlwX2lkIFRFWFQgTk9UIE5VTEwgUkVGRVJFTkNFUyB0cmlwcyhpZCkgT04gREVMRVRFIENBU0NBREUsXHJcbiAgZGlzcGxheV9uYW1lIFRFWFQgTk9UIE5VTEwsXHJcbiAgZW1haWwgVEVYVCxcclxuICBpbml0aWFscyBURVhULFxyXG4gIGNvbG9yIFRFWFQsXHJcbiAgbm90ZXMgVEVYVCxcclxuICBpc19vcmdhbml6ZXIgSU5URUdFUiBERUZBVUxUIDAsXHJcbiAgY3JlYXRlZF9hdCBURVhUIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAsXHJcbiAgdXBkYXRlZF9hdCBURVhUIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVBcclxuKTtcclxuQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgaWR4X3RyYXZlbGVyc190cmlwIE9OIHRyYXZlbGVycyh0cmlwX2lkKTtcclxuXHJcbi0tIEl0ZW1zIHRhYmxlICh1bmlmaWVkIGZvciBhbGwgaXRlbSB0eXBlcylcclxuQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgaXRlbXMgKFxyXG4gIGlkIFRFWFQgUFJJTUFSWSBLRVksXHJcbiAgdHJpcF9pZCBURVhUIE5PVCBOVUxMIFJFRkVSRU5DRVMgdHJpcHMoaWQpIE9OIERFTEVURSBDQVNDQURFLFxyXG4gIHR5cGUgVEVYVCBOT1QgTlVMTCBDSEVDSyAodHlwZSBJTiAoJ2ZsaWdodCcsICd0cmFuc2l0JywgJ3N0YXknLCAnYWN0aXZpdHknKSksXHJcbiAgc3RhdHVzIFRFWFQgREVGQVVMVCAnaWRlYScgQ0hFQ0sgKHN0YXR1cyBJTiAoJ2lkZWEnLCAncGVuZGluZycsICdib29rZWQnLCAnZHJvcHBlZCcpKSxcclxuICB0aXRsZSBURVhUIE5PVCBOVUxMLFxyXG4gIG5vdGVzIFRFWFQsXHJcbiAgbGlua191cmwgVEVYVCxcclxuICBzdGFydF9hdCBURVhULFxyXG4gIGVuZF9hdCBURVhULFxyXG4gIG1ldGFkYXRhIFRFWFQsXHJcbiAgY3JlYXRlZF9hdCBURVhUIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVAsXHJcbiAgdXBkYXRlZF9hdCBURVhUIERFRkFVTFQgQ1VSUkVOVF9USU1FU1RBTVBcclxuKTtcclxuQ1JFQVRFIElOREVYIElGIE5PVCBFWElTVFMgaWR4X2l0ZW1zX3RyaXAgT04gaXRlbXModHJpcF9pZCk7XHJcbkNSRUFURSBJTkRFWCBJRiBOT1QgRVhJU1RTIGlkeF9pdGVtc190eXBlIE9OIGl0ZW1zKHRyaXBfaWQsIHR5cGUpO1xyXG5cclxuLS0gSXRlbS1UcmF2ZWxlciBhc3NpZ25tZW50cyAobWFueS10by1tYW55KVxyXG5DUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyBpdGVtX3RyYXZlbGVycyAoXHJcbiAgaXRlbV9pZCBURVhUIE5PVCBOVUxMIFJFRkVSRU5DRVMgaXRlbXMoaWQpIE9OIERFTEVURSBDQVNDQURFLFxyXG4gIHRyYXZlbGVyX2lkIFRFWFQgTk9UIE5VTEwgUkVGRVJFTkNFUyB0cmF2ZWxlcnMoaWQpIE9OIERFTEVURSBDQVNDQURFLFxyXG4gIHJvbGUgVEVYVCxcclxuICBjcmVhdGVkX2F0IFRFWFQgREVGQVVMVCBDVVJSRU5UX1RJTUVTVEFNUCxcclxuICBQUklNQVJZIEtFWSAoaXRlbV9pZCwgdHJhdmVsZXJfaWQpXHJcbik7XHJcbkNSRUFURSBJTkRFWCBJRiBOT1QgRVhJU1RTIGlkeF9pdGVtX3RyYXZlbGVyc19pdGVtIE9OIGl0ZW1fdHJhdmVsZXJzKGl0ZW1faWQpO1xyXG5DUkVBVEUgSU5ERVggSUYgTk9UIEVYSVNUUyBpZHhfaXRlbV90cmF2ZWxlcnNfdHJhdmVsZXIgT04gaXRlbV90cmF2ZWxlcnModHJhdmVsZXJfaWQpO1xyXG5gO1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gaW5pdERhdGFiYXNlKCkge1xyXG4gICAgaWYgKGRiKSByZXR1cm4gZGI7XHJcblxyXG4gICAgaWYgKCFTUUwpIHtcclxuICAgICAgICBjb25zdCBpbml0U3FsSnMgPSByZXF1aXJlKCdzcWwuanMnKTtcclxuICAgICAgICBTUUwgPSBhd2FpdCBpbml0U3FsSnMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFbnN1cmUgZGF0YSBkaXJlY3RvcnkgZXhpc3RzXHJcbiAgICBjb25zdCBkYXRhRGlyID0gcGF0aC5kaXJuYW1lKERCX1BBVEgpO1xyXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKGRhdGFEaXIpKSB7XHJcbiAgICAgICAgZnMubWtkaXJTeW5jKGRhdGFEaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIExvYWQgZXhpc3RpbmcgZGF0YWJhc2Ugb3IgY3JlYXRlIG5ldyBvbmVcclxuICAgIGlmIChmcy5leGlzdHNTeW5jKERCX1BBVEgpKSB7XHJcbiAgICAgICAgY29uc3QgYnVmZmVyID0gZnMucmVhZEZpbGVTeW5jKERCX1BBVEgpO1xyXG4gICAgICAgIGRiID0gbmV3IFNRTC5EYXRhYmFzZShidWZmZXIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBkYiA9IG5ldyBTUUwuRGF0YWJhc2UoKTtcclxuICAgICAgICAvLyBSdW4gc2NoZW1hXHJcbiAgICAgICAgZGIucnVuKFNDSEVNQSk7XHJcbiAgICAgICAgc2F2ZURhdGFiYXNlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRW5hYmxlIGZvcmVpZ24ga2V5c1xyXG4gICAgZGIucnVuKCdQUkFHTUEgZm9yZWlnbl9rZXlzID0gT04nKTtcclxuXHJcbiAgICByZXR1cm4gZGI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNhdmVEYXRhYmFzZSgpIHtcclxuICAgIGlmIChkYikge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBkYi5leHBvcnQoKTtcclxuICAgICAgICBjb25zdCBidWZmZXIgPSBCdWZmZXIuZnJvbShkYXRhKTtcclxuICAgICAgICBmcy53cml0ZUZpbGVTeW5jKERCX1BBVEgsIGJ1ZmZlcik7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdlbmVyYXRlSWQocHJlZml4ID0gJycpIHtcclxuICAgIGNvbnN0IHRpbWVzdGFtcCA9IERhdGUubm93KCkudG9TdHJpbmcoMzYpO1xyXG4gICAgY29uc3QgcmFuZG9tID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpO1xyXG4gICAgcmV0dXJuIHByZWZpeCA/IGAke3ByZWZpeH0tJHt0aW1lc3RhbXB9LSR7cmFuZG9tfWAgOiBgJHt0aW1lc3RhbXB9LSR7cmFuZG9tfWA7XHJcbn1cclxuXHJcbi8vIFRyaXAgcXVlcmllc1xyXG5jb25zdCB0cmlwcyA9IHtcclxuICAgIGNyZWF0ZTogYXN5bmMgKG5hbWUsIHBhc3Njb2RlSGFzaCwgZGVzdGluYXRpb24gPSAnJywgc3RhcnREYXRlID0gJycsIGVuZERhdGUgPSAnJywgdGltZXpvbmUgPSAnVVRDJykgPT4ge1xyXG4gICAgICAgIGF3YWl0IGluaXREYXRhYmFzZSgpO1xyXG4gICAgICAgIGNvbnN0IGlkID0gZ2VuZXJhdGVJZCgndHJpcCcpO1xyXG4gICAgICAgIGNvbnN0IGNyZWF0ZWRBdCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcclxuICAgICAgICBkYi5ydW4oXHJcbiAgICAgICAgICAgIGBJTlNFUlQgSU5UTyB0cmlwcyAoaWQsIG5hbWUsIGRlc3RpbmF0aW9uLCBzdGFydF9kYXRlLCBlbmRfZGF0ZSwgdGltZXpvbmUsIHBhc3Njb2RlX2hhc2gsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXQpXHJcbiAgICAgICBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8sID8sID8pYCxcclxuICAgICAgICAgICAgW2lkLCBuYW1lLCBkZXN0aW5hdGlvbiwgc3RhcnREYXRlLCBlbmREYXRlLCB0aW1lem9uZSwgcGFzc2NvZGVIYXNoLCBjcmVhdGVkQXQsIGNyZWF0ZWRBdF1cclxuICAgICAgICApO1xyXG4gICAgICAgIHNhdmVEYXRhYmFzZSgpO1xyXG4gICAgICAgIHJldHVybiB7IGlkLCBuYW1lLCBkZXN0aW5hdGlvbiwgc3RhcnREYXRlLCBlbmREYXRlLCB0aW1lem9uZSwgY3JlYXRlZEF0IH07XHJcbiAgICB9LFxyXG5cclxuICAgIGxpc3Q6IGFzeW5jICgpID0+IHtcclxuICAgICAgICBhd2FpdCBpbml0RGF0YWJhc2UoKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBkYi5leGVjKCdTRUxFQ1QgaWQsIG5hbWUsIGRlc3RpbmF0aW9uLCBzdGFydF9kYXRlLCBlbmRfZGF0ZSBGUk9NIHRyaXBzIE9SREVSIEJZIGNyZWF0ZWRfYXQgREVTQycpO1xyXG4gICAgICAgIGlmICghcmVzdWx0Lmxlbmd0aCkgcmV0dXJuIFtdO1xyXG4gICAgICAgIHJldHVybiByZXN1bHRbMF0udmFsdWVzLm1hcChyb3cgPT4gKHtcclxuICAgICAgICAgICAgaWQ6IHJvd1swXSxcclxuICAgICAgICAgICAgbmFtZTogcm93WzFdLFxyXG4gICAgICAgICAgICBkZXN0aW5hdGlvbjogcm93WzJdLFxyXG4gICAgICAgICAgICBzdGFydERhdGU6IHJvd1szXSxcclxuICAgICAgICAgICAgZW5kRGF0ZTogcm93WzRdXHJcbiAgICAgICAgfSkpO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRCeUlkOiBhc3luYyAoaWQpID0+IHtcclxuICAgICAgICBhd2FpdCBpbml0RGF0YWJhc2UoKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBkYi5leGVjKCdTRUxFQ1QgKiBGUk9NIHRyaXBzIFdIRVJFIGlkID0gPycsIFtpZF0pO1xyXG4gICAgICAgIGlmICghcmVzdWx0Lmxlbmd0aCB8fCAhcmVzdWx0WzBdLnZhbHVlcy5sZW5ndGgpIHJldHVybiBudWxsO1xyXG4gICAgICAgIGNvbnN0IHJvdyA9IHJlc3VsdFswXS52YWx1ZXNbMF07XHJcbiAgICAgICAgY29uc3QgY29sdW1ucyA9IHJlc3VsdFswXS5jb2x1bW5zO1xyXG4gICAgICAgIGNvbnN0IHRyaXAgPSB7fTtcclxuICAgICAgICBjb2x1bW5zLmZvckVhY2goKGNvbCwgaSkgPT4ge1xyXG4gICAgICAgICAgICB0cmlwW2NvbF0gPSByb3dbaV07XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRyaXA7XHJcbiAgICB9LFxyXG5cclxuICAgIGdldFBhc3Njb2RlSGFzaDogYXN5bmMgKGlkKSA9PiB7XHJcbiAgICAgICAgYXdhaXQgaW5pdERhdGFiYXNlKCk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZGIuZXhlYygnU0VMRUNUIHBhc3Njb2RlX2hhc2ggRlJPTSB0cmlwcyBXSEVSRSBpZCA9ID8nLCBbaWRdKTtcclxuICAgICAgICBpZiAoIXJlc3VsdC5sZW5ndGggfHwgIXJlc3VsdFswXS52YWx1ZXMubGVuZ3RoKSByZXR1cm4gbnVsbDtcclxuICAgICAgICByZXR1cm4gcmVzdWx0WzBdLnZhbHVlc1swXVswXTtcclxuICAgIH1cclxufTtcclxuXHJcbi8vIFRyYXZlbGVyIHF1ZXJpZXNcclxuY29uc3QgdHJhdmVsZXJzID0ge1xyXG4gICAgY3JlYXRlOiBhc3luYyAodHJpcElkLCBkaXNwbGF5TmFtZSwgZW1haWwgPSAnJywgaW5pdGlhbHMgPSAnJywgY29sb3IgPSAnJywgbm90ZXMgPSAnJywgaXNPcmdhbml6ZXIgPSBmYWxzZSkgPT4ge1xyXG4gICAgICAgIGF3YWl0IGluaXREYXRhYmFzZSgpO1xyXG4gICAgICAgIGNvbnN0IGlkID0gZ2VuZXJhdGVJZCgndCcpO1xyXG4gICAgICAgIGNvbnN0IGNyZWF0ZWRBdCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcclxuICAgICAgICBkYi5ydW4oXHJcbiAgICAgICAgICAgIGBJTlNFUlQgSU5UTyB0cmF2ZWxlcnMgKGlkLCB0cmlwX2lkLCBkaXNwbGF5X25hbWUsIGVtYWlsLCBpbml0aWFscywgY29sb3IsIG5vdGVzLCBpc19vcmdhbml6ZXIsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXQpXHJcbiAgICAgICBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8sID8sID8sID8pYCxcclxuICAgICAgICAgICAgW2lkLCB0cmlwSWQsIGRpc3BsYXlOYW1lLCBlbWFpbCwgaW5pdGlhbHMsIGNvbG9yLCBub3RlcywgaXNPcmdhbml6ZXIgPyAxIDogMCwgY3JlYXRlZEF0LCBjcmVhdGVkQXRdXHJcbiAgICAgICAgKTtcclxuICAgICAgICBzYXZlRGF0YWJhc2UoKTtcclxuICAgICAgICByZXR1cm4geyBpZCwgdHJpcElkLCBkaXNwbGF5TmFtZSwgZW1haWwsIGluaXRpYWxzLCBjb2xvciwgbm90ZXMsIGlzT3JnYW5pemVyLCBjcmVhdGVkQXQgfTtcclxuICAgIH0sXHJcblxyXG4gICAgbGlzdEJ5VHJpcDogYXN5bmMgKHRyaXBJZCkgPT4ge1xyXG4gICAgICAgIGF3YWl0IGluaXREYXRhYmFzZSgpO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGRiLmV4ZWMoXHJcbiAgICAgICAgICAgICdTRUxFQ1QgaWQsIGRpc3BsYXlfbmFtZSwgZW1haWwsIGluaXRpYWxzLCBjb2xvciwgbm90ZXMsIGlzX29yZ2FuaXplciwgY3JlYXRlZF9hdCBGUk9NIHRyYXZlbGVycyBXSEVSRSB0cmlwX2lkID0gPyBPUkRFUiBCWSBjcmVhdGVkX2F0IEFTQycsXHJcbiAgICAgICAgICAgIFt0cmlwSWRdXHJcbiAgICAgICAgKTtcclxuICAgICAgICBpZiAoIXJlc3VsdC5sZW5ndGgpIHJldHVybiBbXTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0WzBdLnZhbHVlcy5tYXAocm93ID0+ICh7XHJcbiAgICAgICAgICAgIGlkOiByb3dbMF0sXHJcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiByb3dbMV0sXHJcbiAgICAgICAgICAgIGVtYWlsOiByb3dbMl0sXHJcbiAgICAgICAgICAgIGluaXRpYWxzOiByb3dbM10sXHJcbiAgICAgICAgICAgIGNvbG9yOiByb3dbNF0sXHJcbiAgICAgICAgICAgIG5vdGVzOiByb3dbNV0sXHJcbiAgICAgICAgICAgIGlzT3JnYW5pemVyOiByb3dbNl0gPT09IDEsXHJcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogcm93WzddXHJcbiAgICAgICAgfSkpO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRCeUlkOiBhc3luYyAoaWQpID0+IHtcclxuICAgICAgICBhd2FpdCBpbml0RGF0YWJhc2UoKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBkYi5leGVjKCdTRUxFQ1QgKiBGUk9NIHRyYXZlbGVycyBXSEVSRSBpZCA9ID8nLCBbaWRdKTtcclxuICAgICAgICBpZiAoIXJlc3VsdC5sZW5ndGggfHwgIXJlc3VsdFswXS52YWx1ZXMubGVuZ3RoKSByZXR1cm4gbnVsbDtcclxuICAgICAgICBjb25zdCByb3cgPSByZXN1bHRbMF0udmFsdWVzWzBdO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGlkOiByb3dbMF0sXHJcbiAgICAgICAgICAgIHRyaXBJZDogcm93WzFdLFxyXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogcm93WzJdLFxyXG4gICAgICAgICAgICBlbWFpbDogcm93WzNdLFxyXG4gICAgICAgICAgICBpbml0aWFsczogcm93WzRdLFxyXG4gICAgICAgICAgICBjb2xvcjogcm93WzVdLFxyXG4gICAgICAgICAgICBub3Rlczogcm93WzZdLFxyXG4gICAgICAgICAgICBpc09yZ2FuaXplcjogcm93WzddID09PSAxLFxyXG4gICAgICAgICAgICBjcmVhdGVkQXQ6IHJvd1s4XSxcclxuICAgICAgICAgICAgdXBkYXRlZEF0OiByb3dbOV1cclxuICAgICAgICB9O1xyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGU6IGFzeW5jIChpZCwgdXBkYXRlcykgPT4ge1xyXG4gICAgICAgIGF3YWl0IGluaXREYXRhYmFzZSgpO1xyXG4gICAgICAgIGNvbnN0IGZpZWxkcyA9IFtdO1xyXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xyXG5cclxuICAgICAgICBpZiAodXBkYXRlcy5kaXNwbGF5TmFtZSAhPT0gdW5kZWZpbmVkKSB7IGZpZWxkcy5wdXNoKCdkaXNwbGF5X25hbWUgPSA/Jyk7IHZhbHVlcy5wdXNoKHVwZGF0ZXMuZGlzcGxheU5hbWUpOyB9XHJcbiAgICAgICAgaWYgKHVwZGF0ZXMuZW1haWwgIT09IHVuZGVmaW5lZCkgeyBmaWVsZHMucHVzaCgnZW1haWwgPSA/Jyk7IHZhbHVlcy5wdXNoKHVwZGF0ZXMuZW1haWwpOyB9XHJcbiAgICAgICAgaWYgKHVwZGF0ZXMuaW5pdGlhbHMgIT09IHVuZGVmaW5lZCkgeyBmaWVsZHMucHVzaCgnaW5pdGlhbHMgPSA/Jyk7IHZhbHVlcy5wdXNoKHVwZGF0ZXMuaW5pdGlhbHMpOyB9XHJcbiAgICAgICAgaWYgKHVwZGF0ZXMuY29sb3IgIT09IHVuZGVmaW5lZCkgeyBmaWVsZHMucHVzaCgnY29sb3IgPSA/Jyk7IHZhbHVlcy5wdXNoKHVwZGF0ZXMuY29sb3IpOyB9XHJcbiAgICAgICAgaWYgKHVwZGF0ZXMubm90ZXMgIT09IHVuZGVmaW5lZCkgeyBmaWVsZHMucHVzaCgnbm90ZXMgPSA/Jyk7IHZhbHVlcy5wdXNoKHVwZGF0ZXMubm90ZXMpOyB9XHJcbiAgICAgICAgaWYgKHVwZGF0ZXMuaXNPcmdhbml6ZXIgIT09IHVuZGVmaW5lZCkgeyBmaWVsZHMucHVzaCgnaXNfb3JnYW5pemVyID0gPycpOyB2YWx1ZXMucHVzaCh1cGRhdGVzLmlzT3JnYW5pemVyID8gMSA6IDApOyB9XHJcblxyXG4gICAgICAgIGlmIChmaWVsZHMubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgIGZpZWxkcy5wdXNoKCd1cGRhdGVkX2F0ID0gPycpO1xyXG4gICAgICAgIHZhbHVlcy5wdXNoKG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSk7XHJcbiAgICAgICAgdmFsdWVzLnB1c2goaWQpO1xyXG5cclxuICAgICAgICBkYi5ydW4oYFVQREFURSB0cmF2ZWxlcnMgU0VUICR7ZmllbGRzLmpvaW4oJywgJyl9IFdIRVJFIGlkID0gP2AsIHZhbHVlcyk7XHJcbiAgICAgICAgc2F2ZURhdGFiYXNlKCk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9LFxyXG5cclxuICAgIGRlbGV0ZTogYXN5bmMgKGlkKSA9PiB7XHJcbiAgICAgICAgYXdhaXQgaW5pdERhdGFiYXNlKCk7XHJcbiAgICAgICAgZGIucnVuKCdERUxFVEUgRlJPTSB0cmF2ZWxlcnMgV0hFUkUgaWQgPSA/JywgW2lkXSk7XHJcbiAgICAgICAgc2F2ZURhdGFiYXNlKCk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vLyBJdGVtIHF1ZXJpZXNcclxuY29uc3QgaXRlbXMgPSB7XHJcbiAgICBjcmVhdGU6IGFzeW5jICh0cmlwSWQsIHR5cGUsIHRpdGxlLCBvcHRpb25zID0ge30pID0+IHtcclxuICAgICAgICBhd2FpdCBpbml0RGF0YWJhc2UoKTtcclxuICAgICAgICBjb25zdCBpZCA9IGdlbmVyYXRlSWQodHlwZS5jaGFyQXQoMCkpO1xyXG4gICAgICAgIGNvbnN0IGNyZWF0ZWRBdCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcclxuICAgICAgICBjb25zdCB7IG5vdGVzID0gJycsIGxpbmtVcmwgPSAnJywgc3RhcnRBdCA9ICcnLCBlbmRBdCA9ICcnLCBzdGF0dXMgPSAnaWRlYScsIG1ldGFkYXRhID0ge30gfSA9IG9wdGlvbnM7XHJcblxyXG4gICAgICAgIGRiLnJ1bihcclxuICAgICAgICAgICAgYElOU0VSVCBJTlRPIGl0ZW1zIChpZCwgdHJpcF9pZCwgdHlwZSwgc3RhdHVzLCB0aXRsZSwgbm90ZXMsIGxpbmtfdXJsLCBzdGFydF9hdCwgZW5kX2F0LCBtZXRhZGF0YSwgY3JlYXRlZF9hdCwgdXBkYXRlZF9hdClcclxuICAgICAgIFZBTFVFUyAoPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPylgLFxyXG4gICAgICAgICAgICBbaWQsIHRyaXBJZCwgdHlwZSwgc3RhdHVzLCB0aXRsZSwgbm90ZXMsIGxpbmtVcmwsIHN0YXJ0QXQsIGVuZEF0LCBKU09OLnN0cmluZ2lmeShtZXRhZGF0YSksIGNyZWF0ZWRBdCwgY3JlYXRlZEF0XVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgc2F2ZURhdGFiYXNlKCk7XHJcbiAgICAgICAgcmV0dXJuIHsgaWQsIHRyaXBJZCwgdHlwZSwgc3RhdHVzLCB0aXRsZSwgbm90ZXMsIGxpbmtVcmwsIHN0YXJ0QXQsIGVuZEF0LCBtZXRhZGF0YSwgY3JlYXRlZEF0LCB0cmF2ZWxlcnM6IFtdIH07XHJcbiAgICB9LFxyXG5cclxuICAgIGxpc3RCeVRyaXA6IGFzeW5jICh0cmlwSWQsIHR5cGUgPSBudWxsKSA9PiB7XHJcbiAgICAgICAgYXdhaXQgaW5pdERhdGFiYXNlKCk7XHJcbiAgICAgICAgbGV0IHF1ZXJ5ID0gJ1NFTEVDVCAqIEZST00gaXRlbXMgV0hFUkUgdHJpcF9pZCA9ID8nO1xyXG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IFt0cmlwSWRdO1xyXG5cclxuICAgICAgICBpZiAodHlwZSkge1xyXG4gICAgICAgICAgICBxdWVyeSArPSAnIEFORCB0eXBlID0gPyc7XHJcbiAgICAgICAgICAgIHBhcmFtcy5wdXNoKHR5cGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcXVlcnkgKz0gJyBPUkRFUiBCWSBzdGFydF9hdCBBU0MsIGNyZWF0ZWRfYXQgQVNDJztcclxuXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZGIuZXhlYyhxdWVyeSwgcGFyYW1zKTtcclxuICAgICAgICBpZiAoIXJlc3VsdC5sZW5ndGgpIHJldHVybiBbXTtcclxuXHJcbiAgICAgICAgY29uc3QgY29sdW1ucyA9IHJlc3VsdFswXS5jb2x1bW5zO1xyXG4gICAgICAgIHJldHVybiByZXN1bHRbMF0udmFsdWVzLm1hcChyb3cgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtID0ge307XHJcbiAgICAgICAgICAgIGNvbHVtbnMuZm9yRWFjaCgoY29sLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29sID09PSAnbWV0YWRhdGEnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVtjb2xdID0gSlNPTi5wYXJzZShyb3dbaV0gfHwgJ3t9Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1bY29sXSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbVtjb2xdID0gcm93W2ldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8gQ29udmVydCBzbmFrZV9jYXNlIHRvIGNhbWVsQ2FzZVxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsXHJcbiAgICAgICAgICAgICAgICB0cmlwSWQ6IGl0ZW0udHJpcF9pZCxcclxuICAgICAgICAgICAgICAgIHR5cGU6IGl0ZW0udHlwZSxcclxuICAgICAgICAgICAgICAgIHN0YXR1czogaXRlbS5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogaXRlbS50aXRsZSxcclxuICAgICAgICAgICAgICAgIG5vdGVzOiBpdGVtLm5vdGVzLFxyXG4gICAgICAgICAgICAgICAgbGlua1VybDogaXRlbS5saW5rX3VybCxcclxuICAgICAgICAgICAgICAgIHN0YXJ0QXQ6IGl0ZW0uc3RhcnRfYXQsXHJcbiAgICAgICAgICAgICAgICBlbmRBdDogaXRlbS5lbmRfYXQsXHJcbiAgICAgICAgICAgICAgICBtZXRhZGF0YTogaXRlbS5tZXRhZGF0YSxcclxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogaXRlbS5jcmVhdGVkX2F0LFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBpdGVtLnVwZGF0ZWRfYXRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0QnlJZDogYXN5bmMgKGlkKSA9PiB7XHJcbiAgICAgICAgYXdhaXQgaW5pdERhdGFiYXNlKCk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gZGIuZXhlYygnU0VMRUNUICogRlJPTSBpdGVtcyBXSEVSRSBpZCA9ID8nLCBbaWRdKTtcclxuICAgICAgICBpZiAoIXJlc3VsdC5sZW5ndGggfHwgIXJlc3VsdFswXS52YWx1ZXMubGVuZ3RoKSByZXR1cm4gbnVsbDtcclxuICAgICAgICBjb25zdCByb3cgPSByZXN1bHRbMF0udmFsdWVzWzBdO1xyXG4gICAgICAgIGNvbnN0IGNvbHVtbnMgPSByZXN1bHRbMF0uY29sdW1ucztcclxuICAgICAgICBjb25zdCBpdGVtID0ge307XHJcbiAgICAgICAgY29sdW1ucy5mb3JFYWNoKChjb2wsIGkpID0+IHtcclxuICAgICAgICAgICAgaWYgKGNvbCA9PT0gJ21ldGFkYXRhJykge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtW2NvbF0gPSBKU09OLnBhcnNlKHJvd1tpXSB8fCAne30nKTtcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1bY29sXSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaXRlbVtjb2xdID0gcm93W2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaWQ6IGl0ZW0uaWQsXHJcbiAgICAgICAgICAgIHRyaXBJZDogaXRlbS50cmlwX2lkLFxyXG4gICAgICAgICAgICB0eXBlOiBpdGVtLnR5cGUsXHJcbiAgICAgICAgICAgIHN0YXR1czogaXRlbS5zdGF0dXMsXHJcbiAgICAgICAgICAgIHRpdGxlOiBpdGVtLnRpdGxlLFxyXG4gICAgICAgICAgICBub3RlczogaXRlbS5ub3RlcyxcclxuICAgICAgICAgICAgbGlua1VybDogaXRlbS5saW5rX3VybCxcclxuICAgICAgICAgICAgc3RhcnRBdDogaXRlbS5zdGFydF9hdCxcclxuICAgICAgICAgICAgZW5kQXQ6IGl0ZW0uZW5kX2F0LFxyXG4gICAgICAgICAgICBtZXRhZGF0YTogaXRlbS5tZXRhZGF0YSxcclxuICAgICAgICAgICAgY3JlYXRlZEF0OiBpdGVtLmNyZWF0ZWRfYXQsXHJcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogaXRlbS51cGRhdGVkX2F0XHJcbiAgICAgICAgfTtcclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlOiBhc3luYyAoaWQsIHVwZGF0ZXMpID0+IHtcclxuICAgICAgICBhd2FpdCBpbml0RGF0YWJhc2UoKTtcclxuICAgICAgICBjb25zdCBmaWVsZHMgPSBbXTtcclxuICAgICAgICBjb25zdCB2YWx1ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgaWYgKHVwZGF0ZXMudGl0bGUgIT09IHVuZGVmaW5lZCkgeyBmaWVsZHMucHVzaCgndGl0bGUgPSA/Jyk7IHZhbHVlcy5wdXNoKHVwZGF0ZXMudGl0bGUpOyB9XHJcbiAgICAgICAgaWYgKHVwZGF0ZXMubm90ZXMgIT09IHVuZGVmaW5lZCkgeyBmaWVsZHMucHVzaCgnbm90ZXMgPSA/Jyk7IHZhbHVlcy5wdXNoKHVwZGF0ZXMubm90ZXMpOyB9XHJcbiAgICAgICAgaWYgKHVwZGF0ZXMubGlua1VybCAhPT0gdW5kZWZpbmVkKSB7IGZpZWxkcy5wdXNoKCdsaW5rX3VybCA9ID8nKTsgdmFsdWVzLnB1c2godXBkYXRlcy5saW5rVXJsKTsgfVxyXG4gICAgICAgIGlmICh1cGRhdGVzLnN0YXJ0QXQgIT09IHVuZGVmaW5lZCkgeyBmaWVsZHMucHVzaCgnc3RhcnRfYXQgPSA/Jyk7IHZhbHVlcy5wdXNoKHVwZGF0ZXMuc3RhcnRBdCk7IH1cclxuICAgICAgICBpZiAodXBkYXRlcy5lbmRBdCAhPT0gdW5kZWZpbmVkKSB7IGZpZWxkcy5wdXNoKCdlbmRfYXQgPSA/Jyk7IHZhbHVlcy5wdXNoKHVwZGF0ZXMuZW5kQXQpOyB9XHJcbiAgICAgICAgaWYgKHVwZGF0ZXMuc3RhdHVzICE9PSB1bmRlZmluZWQpIHsgZmllbGRzLnB1c2goJ3N0YXR1cyA9ID8nKTsgdmFsdWVzLnB1c2godXBkYXRlcy5zdGF0dXMpOyB9XHJcbiAgICAgICAgaWYgKHVwZGF0ZXMubWV0YWRhdGEgIT09IHVuZGVmaW5lZCkgeyBmaWVsZHMucHVzaCgnbWV0YWRhdGEgPSA/Jyk7IHZhbHVlcy5wdXNoKEpTT04uc3RyaW5naWZ5KHVwZGF0ZXMubWV0YWRhdGEpKTsgfVxyXG5cclxuICAgICAgICBpZiAoZmllbGRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICBmaWVsZHMucHVzaCgndXBkYXRlZF9hdCA9ID8nKTtcclxuICAgICAgICB2YWx1ZXMucHVzaChuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkpO1xyXG4gICAgICAgIHZhbHVlcy5wdXNoKGlkKTtcclxuXHJcbiAgICAgICAgZGIucnVuKGBVUERBVEUgaXRlbXMgU0VUICR7ZmllbGRzLmpvaW4oJywgJyl9IFdIRVJFIGlkID0gP2AsIHZhbHVlcyk7XHJcbiAgICAgICAgc2F2ZURhdGFiYXNlKCk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9LFxyXG5cclxuICAgIGRlbGV0ZTogYXN5bmMgKGlkKSA9PiB7XHJcbiAgICAgICAgYXdhaXQgaW5pdERhdGFiYXNlKCk7XHJcbiAgICAgICAgZGIucnVuKCdERUxFVEUgRlJPTSBpdGVtcyBXSEVSRSBpZCA9ID8nLCBbaWRdKTtcclxuICAgICAgICBzYXZlRGF0YWJhc2UoKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufTtcclxuXHJcbi8vIEFzc2lnbm1lbnQgcXVlcmllc1xyXG5jb25zdCBhc3NpZ25tZW50cyA9IHtcclxuICAgIGFzc2lnbjogYXN5bmMgKGl0ZW1JZCwgdHJhdmVsZXJJZCwgcm9sZSA9IG51bGwpID0+IHtcclxuICAgICAgICBhd2FpdCBpbml0RGF0YWJhc2UoKTtcclxuICAgICAgICBjb25zdCBjcmVhdGVkQXQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgZGIucnVuKFxyXG4gICAgICAgICAgICAgICAgJ0lOU0VSVCBPUiBJR05PUkUgSU5UTyBpdGVtX3RyYXZlbGVycyAoaXRlbV9pZCwgdHJhdmVsZXJfaWQsIHJvbGUsIGNyZWF0ZWRfYXQpIFZBTFVFUyAoPywgPywgPywgPyknLFxyXG4gICAgICAgICAgICAgICAgW2l0ZW1JZCwgdHJhdmVsZXJJZCwgcm9sZSwgY3JlYXRlZEF0XVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBzYXZlRGF0YWJhc2UoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHsgaXRlbUlkLCB0cmF2ZWxlcklkLCByb2xlLCBjcmVhdGVkOiB0cnVlIH07XHJcbiAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGl0ZW1JZCwgdHJhdmVsZXJJZCwgcm9sZSwgY3JlYXRlZDogZmFsc2UgfTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHVuYXNzaWduOiBhc3luYyAoaXRlbUlkLCB0cmF2ZWxlcklkKSA9PiB7XHJcbiAgICAgICAgYXdhaXQgaW5pdERhdGFiYXNlKCk7XHJcbiAgICAgICAgZGIucnVuKCdERUxFVEUgRlJPTSBpdGVtX3RyYXZlbGVycyBXSEVSRSBpdGVtX2lkID0gPyBBTkQgdHJhdmVsZXJfaWQgPSA/JywgW2l0ZW1JZCwgdHJhdmVsZXJJZF0pO1xyXG4gICAgICAgIHNhdmVEYXRhYmFzZSgpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRCeUl0ZW06IGFzeW5jIChpdGVtSWQpID0+IHtcclxuICAgICAgICBhd2FpdCBpbml0RGF0YWJhc2UoKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBkYi5leGVjKFxyXG4gICAgICAgICAgICAnU0VMRUNUIHRyYXZlbGVyX2lkLCByb2xlIEZST00gaXRlbV90cmF2ZWxlcnMgV0hFUkUgaXRlbV9pZCA9ID8nLFxyXG4gICAgICAgICAgICBbaXRlbUlkXVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgaWYgKCFyZXN1bHQubGVuZ3RoKSByZXR1cm4gW107XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdFswXS52YWx1ZXMubWFwKHJvdyA9PiAoe1xyXG4gICAgICAgICAgICB0cmF2ZWxlcklkOiByb3dbMF0sXHJcbiAgICAgICAgICAgIHJvbGU6IHJvd1sxXVxyXG4gICAgICAgIH0pKTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0QnlUcmF2ZWxlcjogYXN5bmMgKHRyYXZlbGVySWQpID0+IHtcclxuICAgICAgICBhd2FpdCBpbml0RGF0YWJhc2UoKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBkYi5leGVjKFxyXG4gICAgICAgICAgICAnU0VMRUNUIGl0ZW1faWQsIHJvbGUgRlJPTSBpdGVtX3RyYXZlbGVycyBXSEVSRSB0cmF2ZWxlcl9pZCA9ID8nLFxyXG4gICAgICAgICAgICBbdHJhdmVsZXJJZF1cclxuICAgICAgICApO1xyXG4gICAgICAgIGlmICghcmVzdWx0Lmxlbmd0aCkgcmV0dXJuIFtdO1xyXG4gICAgICAgIHJldHVybiByZXN1bHRbMF0udmFsdWVzLm1hcChyb3cgPT4gKHtcclxuICAgICAgICAgICAgaXRlbUlkOiByb3dbMF0sXHJcbiAgICAgICAgICAgIHJvbGU6IHJvd1sxXVxyXG4gICAgICAgIH0pKTtcclxuICAgIH1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgaW5pdERhdGFiYXNlLFxyXG4gICAgc2F2ZURhdGFiYXNlLFxyXG4gICAgZ2VuZXJhdGVJZCxcclxuICAgIHRyaXBzLFxyXG4gICAgdHJhdmVsZXJzLFxyXG4gICAgaXRlbXMsXHJcbiAgICBhc3NpZ25tZW50c1xyXG59O1xyXG4iXSwibmFtZXMiOlsiZnMiLCJyZXF1aXJlIiwicGF0aCIsIkRCX1BBVEgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImRiIiwiU1FMIiwiU0NIRU1BIiwiaW5pdERhdGFiYXNlIiwiaW5pdFNxbEpzIiwiZGF0YURpciIsImRpcm5hbWUiLCJleGlzdHNTeW5jIiwibWtkaXJTeW5jIiwicmVjdXJzaXZlIiwiYnVmZmVyIiwicmVhZEZpbGVTeW5jIiwiRGF0YWJhc2UiLCJydW4iLCJzYXZlRGF0YWJhc2UiLCJkYXRhIiwiZXhwb3J0IiwiQnVmZmVyIiwiZnJvbSIsIndyaXRlRmlsZVN5bmMiLCJnZW5lcmF0ZUlkIiwicHJlZml4IiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwicmFuZG9tIiwiTWF0aCIsInN1YnN0ciIsInRyaXBzIiwiY3JlYXRlIiwibmFtZSIsInBhc3Njb2RlSGFzaCIsImRlc3RpbmF0aW9uIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsInRpbWV6b25lIiwiaWQiLCJjcmVhdGVkQXQiLCJ0b0lTT1N0cmluZyIsImxpc3QiLCJyZXN1bHQiLCJleGVjIiwibGVuZ3RoIiwidmFsdWVzIiwibWFwIiwicm93IiwiZ2V0QnlJZCIsImNvbHVtbnMiLCJ0cmlwIiwiZm9yRWFjaCIsImNvbCIsImkiLCJnZXRQYXNzY29kZUhhc2giLCJ0cmF2ZWxlcnMiLCJ0cmlwSWQiLCJkaXNwbGF5TmFtZSIsImVtYWlsIiwiaW5pdGlhbHMiLCJjb2xvciIsIm5vdGVzIiwiaXNPcmdhbml6ZXIiLCJsaXN0QnlUcmlwIiwidXBkYXRlZEF0IiwidXBkYXRlIiwidXBkYXRlcyIsImZpZWxkcyIsInVuZGVmaW5lZCIsInB1c2giLCJkZWxldGUiLCJpdGVtcyIsInR5cGUiLCJ0aXRsZSIsIm9wdGlvbnMiLCJjaGFyQXQiLCJsaW5rVXJsIiwic3RhcnRBdCIsImVuZEF0Iiwic3RhdHVzIiwibWV0YWRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwicXVlcnkiLCJwYXJhbXMiLCJpdGVtIiwicGFyc2UiLCJ0cmlwX2lkIiwibGlua191cmwiLCJzdGFydF9hdCIsImVuZF9hdCIsImNyZWF0ZWRfYXQiLCJ1cGRhdGVkX2F0IiwiYXNzaWdubWVudHMiLCJhc3NpZ24iLCJpdGVtSWQiLCJ0cmF2ZWxlcklkIiwicm9sZSIsImNyZWF0ZWQiLCJ1bmFzc2lnbiIsImdldEJ5SXRlbSIsImdldEJ5VHJhdmVsZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/db.js\n");

/***/ }),

/***/ "(api)/./lib/rate-limit.js":
/*!***************************!*\
  !*** ./lib/rate-limit.js ***!
  \***************************/
/***/ ((module) => {

eval("/**\r\n * Rate Limiting Module - Simple in-memory rate limiter for unlock attempts\r\n */ // Store: { key: { count: number, resetAt: number } }\n\nconst attempts = new Map();\nconst WINDOW_MS = 15 * 60 * 1000; // 15 minutes\nconst MAX_ATTEMPTS = 5;\n/**\r\n * Check if a request should be rate limited\r\n * @param {string} key - Unique identifier (e.g., IP + tripId)\r\n * @returns {{ limited: boolean, remaining: number, retryAfter?: number }}\r\n */ function checkRateLimit(key) {\n    const now = Date.now();\n    const record = attempts.get(key);\n    // Clean up expired records\n    if (record && now >= record.resetAt) {\n        attempts.delete(key);\n    }\n    const current = attempts.get(key);\n    if (!current) {\n        // First attempt\n        attempts.set(key, {\n            count: 1,\n            resetAt: now + WINDOW_MS\n        });\n        return {\n            limited: false,\n            remaining: MAX_ATTEMPTS - 1\n        };\n    }\n    if (current.count >= MAX_ATTEMPTS) {\n        const retryAfter = Math.ceil((current.resetAt - now) / 1000);\n        return {\n            limited: true,\n            remaining: 0,\n            retryAfter\n        };\n    }\n    // Increment count\n    current.count += 1;\n    attempts.set(key, current);\n    return {\n        limited: false,\n        remaining: MAX_ATTEMPTS - current.count\n    };\n}\n/**\r\n * Reset rate limit for a key (e.g., after successful unlock)\r\n */ function resetRateLimit(key) {\n    attempts.delete(key);\n}\n/**\r\n * Get rate limit key from request\r\n */ function getRateLimitKey(req, tripId) {\n    // Get IP from various headers\n    const ip = req.headers[\"x-forwarded-for\"]?.split(\",\")[0]?.trim() || req.headers[\"x-real-ip\"] || req.socket?.remoteAddress || \"unknown\";\n    return `${ip}:${tripId}`;\n}\nmodule.exports = {\n    checkRateLimit,\n    resetRateLimit,\n    getRateLimitKey\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvcmF0ZS1saW1pdC5qcyIsIm1hcHBpbmdzIjoiQUFBQTs7Q0FFQyxHQUVELHFEQUFxRDs7QUFDckQsTUFBTUEsV0FBVyxJQUFJQztBQUVyQixNQUFNQyxZQUFZLEtBQUssS0FBSyxNQUFNLGFBQWE7QUFDL0MsTUFBTUMsZUFBZTtBQUVyQjs7OztDQUlDLEdBQ0QsU0FBU0MsZUFBZUMsR0FBRztJQUN2QixNQUFNQyxNQUFNQyxLQUFLRCxHQUFHO0lBQ3BCLE1BQU1FLFNBQVNSLFNBQVNTLEdBQUcsQ0FBQ0o7SUFFNUIsMkJBQTJCO0lBQzNCLElBQUlHLFVBQVVGLE9BQU9FLE9BQU9FLE9BQU8sRUFBRTtRQUNqQ1YsU0FBU1csTUFBTSxDQUFDTjtJQUNwQjtJQUVBLE1BQU1PLFVBQVVaLFNBQVNTLEdBQUcsQ0FBQ0o7SUFFN0IsSUFBSSxDQUFDTyxTQUFTO1FBQ1YsZ0JBQWdCO1FBQ2hCWixTQUFTYSxHQUFHLENBQUNSLEtBQUs7WUFDZFMsT0FBTztZQUNQSixTQUFTSixNQUFNSjtRQUNuQjtRQUNBLE9BQU87WUFBRWEsU0FBUztZQUFPQyxXQUFXYixlQUFlO1FBQUU7SUFDekQ7SUFFQSxJQUFJUyxRQUFRRSxLQUFLLElBQUlYLGNBQWM7UUFDL0IsTUFBTWMsYUFBYUMsS0FBS0MsSUFBSSxDQUFDLENBQUNQLFFBQVFGLE9BQU8sR0FBR0osR0FBRSxJQUFLO1FBQ3ZELE9BQU87WUFBRVMsU0FBUztZQUFNQyxXQUFXO1lBQUdDO1FBQVc7SUFDckQ7SUFFQSxrQkFBa0I7SUFDbEJMLFFBQVFFLEtBQUssSUFBSTtJQUNqQmQsU0FBU2EsR0FBRyxDQUFDUixLQUFLTztJQUVsQixPQUFPO1FBQUVHLFNBQVM7UUFBT0MsV0FBV2IsZUFBZVMsUUFBUUUsS0FBSztJQUFDO0FBQ3JFO0FBRUE7O0NBRUMsR0FDRCxTQUFTTSxlQUFlZixHQUFHO0lBQ3ZCTCxTQUFTVyxNQUFNLENBQUNOO0FBQ3BCO0FBRUE7O0NBRUMsR0FDRCxTQUFTZ0IsZ0JBQWdCQyxHQUFHLEVBQUVDLE1BQU07SUFDaEMsOEJBQThCO0lBQzlCLE1BQU1DLEtBQUtGLElBQUlHLE9BQU8sQ0FBQyxrQkFBa0IsRUFBRUMsTUFBTSxJQUFJLENBQUMsRUFBRSxFQUFFQyxVQUN0REwsSUFBSUcsT0FBTyxDQUFDLFlBQVksSUFDeEJILElBQUlNLE1BQU0sRUFBRUMsaUJBQ1o7SUFDSixPQUFPLENBQUMsRUFBRUwsR0FBRyxDQUFDLEVBQUVELE9BQU8sQ0FBQztBQUM1QjtBQUVBTyxPQUFPQyxPQUFPLEdBQUc7SUFDYjNCO0lBQ0FnQjtJQUNBQztBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmFuZ2luLXRyYXZlbC8uL2xpYi9yYXRlLWxpbWl0LmpzPzA3NmMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFJhdGUgTGltaXRpbmcgTW9kdWxlIC0gU2ltcGxlIGluLW1lbW9yeSByYXRlIGxpbWl0ZXIgZm9yIHVubG9jayBhdHRlbXB0c1xyXG4gKi9cclxuXHJcbi8vIFN0b3JlOiB7IGtleTogeyBjb3VudDogbnVtYmVyLCByZXNldEF0OiBudW1iZXIgfSB9XHJcbmNvbnN0IGF0dGVtcHRzID0gbmV3IE1hcCgpO1xyXG5cclxuY29uc3QgV0lORE9XX01TID0gMTUgKiA2MCAqIDEwMDA7IC8vIDE1IG1pbnV0ZXNcclxuY29uc3QgTUFYX0FUVEVNUFRTID0gNTtcclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiBhIHJlcXVlc3Qgc2hvdWxkIGJlIHJhdGUgbGltaXRlZFxyXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gVW5pcXVlIGlkZW50aWZpZXIgKGUuZy4sIElQICsgdHJpcElkKVxyXG4gKiBAcmV0dXJucyB7eyBsaW1pdGVkOiBib29sZWFuLCByZW1haW5pbmc6IG51bWJlciwgcmV0cnlBZnRlcj86IG51bWJlciB9fVxyXG4gKi9cclxuZnVuY3Rpb24gY2hlY2tSYXRlTGltaXQoa2V5KSB7XHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgY29uc3QgcmVjb3JkID0gYXR0ZW1wdHMuZ2V0KGtleSk7XHJcblxyXG4gICAgLy8gQ2xlYW4gdXAgZXhwaXJlZCByZWNvcmRzXHJcbiAgICBpZiAocmVjb3JkICYmIG5vdyA+PSByZWNvcmQucmVzZXRBdCkge1xyXG4gICAgICAgIGF0dGVtcHRzLmRlbGV0ZShrZXkpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGN1cnJlbnQgPSBhdHRlbXB0cy5nZXQoa2V5KTtcclxuXHJcbiAgICBpZiAoIWN1cnJlbnQpIHtcclxuICAgICAgICAvLyBGaXJzdCBhdHRlbXB0XHJcbiAgICAgICAgYXR0ZW1wdHMuc2V0KGtleSwge1xyXG4gICAgICAgICAgICBjb3VudDogMSxcclxuICAgICAgICAgICAgcmVzZXRBdDogbm93ICsgV0lORE9XX01TXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHsgbGltaXRlZDogZmFsc2UsIHJlbWFpbmluZzogTUFYX0FUVEVNUFRTIC0gMSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjdXJyZW50LmNvdW50ID49IE1BWF9BVFRFTVBUUykge1xyXG4gICAgICAgIGNvbnN0IHJldHJ5QWZ0ZXIgPSBNYXRoLmNlaWwoKGN1cnJlbnQucmVzZXRBdCAtIG5vdykgLyAxMDAwKTtcclxuICAgICAgICByZXR1cm4geyBsaW1pdGVkOiB0cnVlLCByZW1haW5pbmc6IDAsIHJldHJ5QWZ0ZXIgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJbmNyZW1lbnQgY291bnRcclxuICAgIGN1cnJlbnQuY291bnQgKz0gMTtcclxuICAgIGF0dGVtcHRzLnNldChrZXksIGN1cnJlbnQpO1xyXG5cclxuICAgIHJldHVybiB7IGxpbWl0ZWQ6IGZhbHNlLCByZW1haW5pbmc6IE1BWF9BVFRFTVBUUyAtIGN1cnJlbnQuY291bnQgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlc2V0IHJhdGUgbGltaXQgZm9yIGEga2V5IChlLmcuLCBhZnRlciBzdWNjZXNzZnVsIHVubG9jaylcclxuICovXHJcbmZ1bmN0aW9uIHJlc2V0UmF0ZUxpbWl0KGtleSkge1xyXG4gICAgYXR0ZW1wdHMuZGVsZXRlKGtleSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgcmF0ZSBsaW1pdCBrZXkgZnJvbSByZXF1ZXN0XHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRSYXRlTGltaXRLZXkocmVxLCB0cmlwSWQpIHtcclxuICAgIC8vIEdldCBJUCBmcm9tIHZhcmlvdXMgaGVhZGVyc1xyXG4gICAgY29uc3QgaXAgPSByZXEuaGVhZGVyc1sneC1mb3J3YXJkZWQtZm9yJ10/LnNwbGl0KCcsJylbMF0/LnRyaW0oKSB8fFxyXG4gICAgICAgIHJlcS5oZWFkZXJzWyd4LXJlYWwtaXAnXSB8fFxyXG4gICAgICAgIHJlcS5zb2NrZXQ/LnJlbW90ZUFkZHJlc3MgfHxcclxuICAgICAgICAndW5rbm93bic7XHJcbiAgICByZXR1cm4gYCR7aXB9OiR7dHJpcElkfWA7XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY2hlY2tSYXRlTGltaXQsXHJcbiAgICByZXNldFJhdGVMaW1pdCxcclxuICAgIGdldFJhdGVMaW1pdEtleVxyXG59O1xyXG4iXSwibmFtZXMiOlsiYXR0ZW1wdHMiLCJNYXAiLCJXSU5ET1dfTVMiLCJNQVhfQVRURU1QVFMiLCJjaGVja1JhdGVMaW1pdCIsImtleSIsIm5vdyIsIkRhdGUiLCJyZWNvcmQiLCJnZXQiLCJyZXNldEF0IiwiZGVsZXRlIiwiY3VycmVudCIsInNldCIsImNvdW50IiwibGltaXRlZCIsInJlbWFpbmluZyIsInJldHJ5QWZ0ZXIiLCJNYXRoIiwiY2VpbCIsInJlc2V0UmF0ZUxpbWl0IiwiZ2V0UmF0ZUxpbWl0S2V5IiwicmVxIiwidHJpcElkIiwiaXAiLCJoZWFkZXJzIiwic3BsaXQiLCJ0cmltIiwic29ja2V0IiwicmVtb3RlQWRkcmVzcyIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/rate-limit.js\n");

/***/ }),

/***/ "(api)/./pages/api/trips/[tripId]/unlock.js":
/*!********************************************!*\
  !*** ./pages/api/trips/[tripId]/unlock.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/**\r\n * API Route: /api/trips/[tripId]/unlock\r\n * POST - Verify passcode and return token\r\n */ const { trips } = __webpack_require__(/*! ../../../../lib/db */ \"(api)/./lib/db.js\");\nconst { verifyPasscode, generateToken, getTokenExpiry } = __webpack_require__(/*! ../../../../lib/auth */ \"(api)/./lib/auth.js\");\nconst { checkRateLimit, resetRateLimit, getRateLimitKey } = __webpack_require__(/*! ../../../../lib/rate-limit */ \"(api)/./lib/rate-limit.js\");\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        res.setHeader(\"Allow\", [\n            \"POST\"\n        ]);\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    const { tripId } = req.query;\n    // Check rate limit\n    const rateLimitKey = getRateLimitKey(req, tripId);\n    const rateLimit = checkRateLimit(rateLimitKey);\n    if (rateLimit.limited) {\n        res.setHeader(\"Retry-After\", rateLimit.retryAfter);\n        return res.status(429).json({\n            error: \"Too many unlock attempts\",\n            retryAfter: rateLimit.retryAfter\n        });\n    }\n    try {\n        const { passcode } = req.body;\n        if (!passcode || typeof passcode !== \"string\") {\n            return res.status(400).json({\n                error: \"Passcode is required\"\n            });\n        }\n        // Get trip passcode hash\n        const passcodeHash = await trips.getPasscodeHash(tripId);\n        if (!passcodeHash) {\n            return res.status(404).json({\n                error: \"Trip not found\"\n            });\n        }\n        // Verify passcode\n        const valid = await verifyPasscode(passcode, passcodeHash);\n        if (!valid) {\n            return res.status(401).json({\n                error: \"Invalid passcode\",\n                attemptsRemaining: rateLimit.remaining\n            });\n        }\n        // Reset rate limit on success\n        resetRateLimit(rateLimitKey);\n        // Generate token\n        const token = generateToken(tripId);\n        const expiresAt = getTokenExpiry(token);\n        return res.status(200).json({\n            token,\n            expiresAt\n        });\n    } catch (error) {\n        console.error(\"Unlock trip error:\", error);\n        return res.status(500).json({\n            error: \"Failed to unlock trip\"\n        });\n    }\n}\n;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvdHJpcHMvW3RyaXBJZF0vdW5sb2NrLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0NBR0MsR0FFRCxNQUFNLEVBQUVBLEtBQUssRUFBRSxHQUFHQyxtQkFBT0EsQ0FBQztBQUMxQixNQUFNLEVBQUVDLGNBQWMsRUFBRUMsYUFBYSxFQUFFQyxjQUFjLEVBQUUsR0FBR0gsbUJBQU9BLENBQUM7QUFDbEUsTUFBTSxFQUFFSSxjQUFjLEVBQUVDLGNBQWMsRUFBRUMsZUFBZSxFQUFFLEdBQUdOLG1CQUFPQSxDQUFDO0FBRXJELGVBQWVPLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUMxQyxJQUFJRCxJQUFJRSxNQUFNLEtBQUssUUFBUTtRQUN2QkQsSUFBSUUsU0FBUyxDQUFDLFNBQVM7WUFBQztTQUFPO1FBQy9CLE9BQU9GLElBQUlHLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFxQjtJQUM5RDtJQUVBLE1BQU0sRUFBRUMsTUFBTSxFQUFFLEdBQUdQLElBQUlRLEtBQUs7SUFFNUIsbUJBQW1CO0lBQ25CLE1BQU1DLGVBQWVYLGdCQUFnQkUsS0FBS087SUFDMUMsTUFBTUcsWUFBWWQsZUFBZWE7SUFFakMsSUFBSUMsVUFBVUMsT0FBTyxFQUFFO1FBQ25CVixJQUFJRSxTQUFTLENBQUMsZUFBZU8sVUFBVUUsVUFBVTtRQUNqRCxPQUFPWCxJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQ3hCQyxPQUFPO1lBQ1BNLFlBQVlGLFVBQVVFLFVBQVU7UUFDcEM7SUFDSjtJQUVBLElBQUk7UUFDQSxNQUFNLEVBQUVDLFFBQVEsRUFBRSxHQUFHYixJQUFJYyxJQUFJO1FBRTdCLElBQUksQ0FBQ0QsWUFBWSxPQUFPQSxhQUFhLFVBQVU7WUFDM0MsT0FBT1osSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUF1QjtRQUNoRTtRQUVBLHlCQUF5QjtRQUN6QixNQUFNUyxlQUFlLE1BQU14QixNQUFNeUIsZUFBZSxDQUFDVDtRQUVqRCxJQUFJLENBQUNRLGNBQWM7WUFDZixPQUFPZCxJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQWlCO1FBQzFEO1FBRUEsa0JBQWtCO1FBQ2xCLE1BQU1XLFFBQVEsTUFBTXhCLGVBQWVvQixVQUFVRTtRQUU3QyxJQUFJLENBQUNFLE9BQU87WUFDUixPQUFPaEIsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFDeEJDLE9BQU87Z0JBQ1BZLG1CQUFtQlIsVUFBVVMsU0FBUztZQUMxQztRQUNKO1FBRUEsOEJBQThCO1FBQzlCdEIsZUFBZVk7UUFFZixpQkFBaUI7UUFDakIsTUFBTVcsUUFBUTFCLGNBQWNhO1FBQzVCLE1BQU1jLFlBQVkxQixlQUFleUI7UUFFakMsT0FBT25CLElBQUlHLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDeEJlO1lBQ0FDO1FBQ0o7SUFDSixFQUFFLE9BQU9mLE9BQU87UUFDWmdCLFFBQVFoQixLQUFLLENBQUMsc0JBQXNCQTtRQUNwQyxPQUFPTCxJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBd0I7SUFDakU7QUFDSiIsInNvdXJjZXMiOlsid2VicGFjazovL2Jhbmdpbi10cmF2ZWwvLi9wYWdlcy9hcGkvdHJpcHMvW3RyaXBJZF0vdW5sb2NrLmpzPzJkNGUiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEFQSSBSb3V0ZTogL2FwaS90cmlwcy9bdHJpcElkXS91bmxvY2tcclxuICogUE9TVCAtIFZlcmlmeSBwYXNzY29kZSBhbmQgcmV0dXJuIHRva2VuXHJcbiAqL1xyXG5cclxuY29uc3QgeyB0cmlwcyB9ID0gcmVxdWlyZSgnLi4vLi4vLi4vLi4vbGliL2RiJyk7XHJcbmNvbnN0IHsgdmVyaWZ5UGFzc2NvZGUsIGdlbmVyYXRlVG9rZW4sIGdldFRva2VuRXhwaXJ5IH0gPSByZXF1aXJlKCcuLi8uLi8uLi8uLi9saWIvYXV0aCcpO1xyXG5jb25zdCB7IGNoZWNrUmF0ZUxpbWl0LCByZXNldFJhdGVMaW1pdCwgZ2V0UmF0ZUxpbWl0S2V5IH0gPSByZXF1aXJlKCcuLi8uLi8uLi8uLi9saWIvcmF0ZS1saW1pdCcpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xyXG4gICAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xyXG4gICAgICAgIHJlcy5zZXRIZWFkZXIoJ0FsbG93JywgWydQT1NUJ10pO1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IHRyaXBJZCB9ID0gcmVxLnF1ZXJ5O1xyXG5cclxuICAgIC8vIENoZWNrIHJhdGUgbGltaXRcclxuICAgIGNvbnN0IHJhdGVMaW1pdEtleSA9IGdldFJhdGVMaW1pdEtleShyZXEsIHRyaXBJZCk7XHJcbiAgICBjb25zdCByYXRlTGltaXQgPSBjaGVja1JhdGVMaW1pdChyYXRlTGltaXRLZXkpO1xyXG5cclxuICAgIGlmIChyYXRlTGltaXQubGltaXRlZCkge1xyXG4gICAgICAgIHJlcy5zZXRIZWFkZXIoJ1JldHJ5LUFmdGVyJywgcmF0ZUxpbWl0LnJldHJ5QWZ0ZXIpO1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQyOSkuanNvbih7XHJcbiAgICAgICAgICAgIGVycm9yOiAnVG9vIG1hbnkgdW5sb2NrIGF0dGVtcHRzJyxcclxuICAgICAgICAgICAgcmV0cnlBZnRlcjogcmF0ZUxpbWl0LnJldHJ5QWZ0ZXJcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHsgcGFzc2NvZGUgfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgICAgICBpZiAoIXBhc3Njb2RlIHx8IHR5cGVvZiBwYXNzY29kZSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdQYXNzY29kZSBpcyByZXF1aXJlZCcgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBHZXQgdHJpcCBwYXNzY29kZSBoYXNoXHJcbiAgICAgICAgY29uc3QgcGFzc2NvZGVIYXNoID0gYXdhaXQgdHJpcHMuZ2V0UGFzc2NvZGVIYXNoKHRyaXBJZCk7XHJcblxyXG4gICAgICAgIGlmICghcGFzc2NvZGVIYXNoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnVHJpcCBub3QgZm91bmQnIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVmVyaWZ5IHBhc3Njb2RlXHJcbiAgICAgICAgY29uc3QgdmFsaWQgPSBhd2FpdCB2ZXJpZnlQYXNzY29kZShwYXNzY29kZSwgcGFzc2NvZGVIYXNoKTtcclxuXHJcbiAgICAgICAgaWYgKCF2YWxpZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oe1xyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHBhc3Njb2RlJyxcclxuICAgICAgICAgICAgICAgIGF0dGVtcHRzUmVtYWluaW5nOiByYXRlTGltaXQucmVtYWluaW5nXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUmVzZXQgcmF0ZSBsaW1pdCBvbiBzdWNjZXNzXHJcbiAgICAgICAgcmVzZXRSYXRlTGltaXQocmF0ZUxpbWl0S2V5KTtcclxuXHJcbiAgICAgICAgLy8gR2VuZXJhdGUgdG9rZW5cclxuICAgICAgICBjb25zdCB0b2tlbiA9IGdlbmVyYXRlVG9rZW4odHJpcElkKTtcclxuICAgICAgICBjb25zdCBleHBpcmVzQXQgPSBnZXRUb2tlbkV4cGlyeSh0b2tlbik7XHJcblxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgICAgICAgIHRva2VuLFxyXG4gICAgICAgICAgICBleHBpcmVzQXRcclxuICAgICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignVW5sb2NrIHRyaXAgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIHVubG9jayB0cmlwJyB9KTtcclxuICAgIH1cclxufTtcclxuIl0sIm5hbWVzIjpbInRyaXBzIiwicmVxdWlyZSIsInZlcmlmeVBhc3Njb2RlIiwiZ2VuZXJhdGVUb2tlbiIsImdldFRva2VuRXhwaXJ5IiwiY2hlY2tSYXRlTGltaXQiLCJyZXNldFJhdGVMaW1pdCIsImdldFJhdGVMaW1pdEtleSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzZXRIZWFkZXIiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJ0cmlwSWQiLCJxdWVyeSIsInJhdGVMaW1pdEtleSIsInJhdGVMaW1pdCIsImxpbWl0ZWQiLCJyZXRyeUFmdGVyIiwicGFzc2NvZGUiLCJib2R5IiwicGFzc2NvZGVIYXNoIiwiZ2V0UGFzc2NvZGVIYXNoIiwidmFsaWQiLCJhdHRlbXB0c1JlbWFpbmluZyIsInJlbWFpbmluZyIsInRva2VuIiwiZXhwaXJlc0F0IiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/trips/[tripId]/unlock.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftrips%2F%5BtripId%5D%2Funlock&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ctrips%5C%5BtripId%5D%5Cunlock.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();